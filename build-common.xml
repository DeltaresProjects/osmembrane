<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="fail">

	<target name="fail">
		<fail message="This file is not intended to be called directly. Use build.xml instead."/>	  
	</target>

	<target name="_get-version" unless="${project.version}">
		<condition property="git.command" value="git.cmd">
			<os family="windows" />
		</condition>
		<condition property="git.command" value="git">
			<not><os family="windows" /></not>
		</condition>
		
		<exec executable="${git.command}" dir="${basedir}" outputproperty="git.revision" failonerror="true">
			<arg value="log"/>
			<arg value="--pretty=format:%h"/>
			<arg value="-1"/>
		</exec>
		<property name="project.version" value="SNAPSHOT-${git.revision}" />
	</target>
	
	<target name="update_constants_revision" depends="_get-version">
		<propertyfile file="${version.properties.path}" 
			comment="This file has been generated automatically during the build process.">
			<entry key="de.osmembrane.version.buildNumber" value="${project.version}" />
		</propertyfile>
	</target>
</project>